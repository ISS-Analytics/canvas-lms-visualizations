<?xml version="1.0" encoding="UTF-8"?>
<mxGraphModel dx="882" dy="502" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="826" pageHeight="1169" background="#ffffff" math="0"><root><mxCell id="0"/><mxCell id="1" parent="0"/><mxCell id="2" value="How we store tokens" style="swimlane;html=1;childLayout=stackLayout;horizontal=1;startSize=20;horizontalStack=0;" vertex="1" parent="1"><mxGeometry x="27" y="70" width="770" height="340" as="geometry"/></mxCell><mxCell id="10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;exitPerimeter=0;jettySize=auto;orthogonalLoop=1;" edge="1" parent="2" source="8" target="9"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.93;exitY=0.5;exitPerimeter=0;entryX=0.095;entryY=0.5;entryPerimeter=0;jettySize=auto;orthogonalLoop=1;" edge="1" parent="2" source="9" target="6"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="188" y="190"/><mxPoint x="188" y="80"/></Array></mxGeometry></mxCell><mxCell id="12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;exitPerimeter=0;entryX=0.5;entryY=0;entryPerimeter=0;jettySize=auto;orthogonalLoop=1;" edge="1" parent="2" source="6" target="7"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="21" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;exitPerimeter=0;entryX=0.5;entryY=0;entryPerimeter=0;jettySize=auto;orthogonalLoop=1;" edge="1" parent="2" source="6" target="20"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="24" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;exitPerimeter=0;entryX=0.5;entryY=0;entryPerimeter=0;jettySize=auto;orthogonalLoop=1;" edge="1" parent="2" source="17" target="23"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="3" value="User" style="swimlane;html=1;startSize=20;horizontal=0;" vertex="1" parent="2"><mxGeometry y="20" width="770" height="120" as="geometry"/></mxCell><mxCell id="6" value="Provide&lt;br&gt;Password" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.data;whiteSpace=wrap;" vertex="1" parent="3"><mxGeometry x="303" y="40" width="100" height="40" as="geometry"/></mxCell><mxCell id="8" value="Google&lt;br&gt;OAuth Flow" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.process;whiteSpace=wrap;" vertex="1" parent="3"><mxGeometry x="68" y="67" width="80" height="40" as="geometry"/></mxCell><mxCell id="17" value="Canvas&lt;br&gt;Token" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.data;whiteSpace=wrap;" vertex="1" parent="3"><mxGeometry x="603" y="40" width="100" height="40" as="geometry"/></mxCell><mxCell id="73" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;exitPerimeter=0;entryX=0.5;entryY=0;entryPerimeter=0;startArrow=none;startFill=0;endArrow=classic;endFill=1;jettySize=auto;orthogonalLoop=1;" edge="1" parent="3" source="71" target="8"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="71" value="Start" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.start_2;whiteSpace=wrap;" vertex="1" parent="3"><mxGeometry x="33" y="7" width="47" height="47" as="geometry"/></mxCell><mxCell id="4" value="System" style="swimlane;html=1;startSize=20;horizontal=0;" vertex="1" parent="2"><mxGeometry y="140" width="770" height="200" as="geometry"/></mxCell><mxCell id="14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;exitPerimeter=0;entryX=0.5;entryY=0;entryPerimeter=0;jettySize=auto;orthogonalLoop=1;" edge="1" parent="4" source="7" target="15"><mxGeometry relative="1" as="geometry"><mxPoint x="258" y="140" as="targetPoint"/><Array as="points"/></mxGeometry></mxCell><mxCell id="7" value="Hash&lt;br&gt;Password&lt;br&gt;(64 bytes)" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.process;whiteSpace=wrap;" vertex="1" parent="4"><mxGeometry x="208" y="20" width="100" height="60" as="geometry"/></mxCell><mxCell id="9" value="Email&lt;br&gt;Address" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.stored_data;whiteSpace=wrap;" vertex="1" parent="4"><mxGeometry x="58" y="80" width="100" height="60" as="geometry"/></mxCell><mxCell id="15" value="&lt;div&gt;&lt;span style=&quot;line-height: 1.2&quot;&gt;Hashed Password&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;line-height: 1.2&quot;&gt;(64 bytes)&lt;/span&gt;&lt;/div&gt;" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.stored_data;whiteSpace=wrap;" vertex="1" parent="4"><mxGeometry x="208" y="120" width="100" height="60" as="geometry"/></mxCell><mxCell id="25" value="Encryption&lt;br&gt;Nonce" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;exitPerimeter=0;entryX=0;entryY=0.5;entryPerimeter=0;jettySize=auto;orthogonalLoop=1;" edge="1" parent="4" source="19" target="23"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="19" value="Hashed Password&lt;div&gt;(24 bytes)&lt;/div&gt;" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.delay;whiteSpace=wrap;" vertex="1" parent="4"><mxGeometry x="423" y="120" width="97" height="60" as="geometry"/></mxCell><mxCell id="22" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;exitPerimeter=0;entryX=0.5;entryY=0;entryPerimeter=0;jettySize=auto;orthogonalLoop=1;" edge="1" parent="4" source="20" target="19"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="20" value="Hash&lt;br&gt;Password&lt;br&gt;(24 bytes)" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.process;whiteSpace=wrap;" vertex="1" parent="4"><mxGeometry x="386" y="20" width="100" height="60" as="geometry"/></mxCell><mxCell id="27" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;exitPerimeter=0;entryX=0.5;entryY=0;entryPerimeter=0;jettySize=auto;orthogonalLoop=1;" edge="1" parent="4" source="23" target="26"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="23" value="Encrypt&lt;br&gt;token" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.process;whiteSpace=wrap;" vertex="1" parent="4"><mxGeometry x="603" y="20" width="100" height="60" as="geometry"/></mxCell><mxCell id="26" value="Encrypted&lt;br&gt;token" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.stored_data;whiteSpace=wrap;" vertex="1" parent="4"><mxGeometry x="603" y="120" width="100" height="60" as="geometry"/></mxCell><mxCell id="32" value="How we access a saved token" style="swimlane;html=1;childLayout=stackLayout;horizontal=1;startSize=20;horizontalStack=0;" vertex="1" parent="1"><mxGeometry x="27" y="449" width="770" height="440" as="geometry"/></mxCell><mxCell id="37" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;exitPerimeter=0;jettySize=auto;orthogonalLoop=1;" edge="1" parent="32" source="35" target="45"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="38" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.93;exitY=0.5;exitPerimeter=0;entryX=0.095;entryY=0.5;entryPerimeter=0;jettySize=auto;orthogonalLoop=1;" edge="1" parent="32" source="45" target="34"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="188" y="230"/><mxPoint x="188" y="80"/></Array></mxGeometry></mxCell><mxCell id="39" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;exitPerimeter=0;entryX=0.5;entryY=0;entryPerimeter=0;jettySize=auto;orthogonalLoop=1;" edge="1" parent="32" source="34" target="44"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="40" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;exitPerimeter=0;entryX=0.5;entryY=0;entryPerimeter=0;jettySize=auto;orthogonalLoop=1;" edge="1" parent="32" source="34" target="50"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="33" value="User" style="swimlane;html=1;startSize=20;horizontal=0;" vertex="1" parent="32"><mxGeometry y="20" width="770" height="120" as="geometry"/></mxCell><mxCell id="34" value="Provide&lt;br&gt;Password" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.data;whiteSpace=wrap;" vertex="1" parent="33"><mxGeometry x="303" y="40" width="100" height="40" as="geometry"/></mxCell><mxCell id="35" value="Google&lt;br&gt;OAuth Flow" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.process;whiteSpace=wrap;" vertex="1" parent="33"><mxGeometry x="82" y="70" width="80" height="40" as="geometry"/></mxCell><mxCell id="62" value="Request Data&lt;br&gt;From Canvas" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.process;whiteSpace=wrap;" vertex="1" parent="33"><mxGeometry x="460" y="34" width="100" height="60" as="geometry"/></mxCell><mxCell id="75" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;exitPerimeter=0;entryX=0.5;entryY=0;entryPerimeter=0;startArrow=none;startFill=0;endArrow=classic;endFill=1;jettySize=auto;orthogonalLoop=1;" edge="1" parent="33" source="74" target="35"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="74" value="Start" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.start_2;whiteSpace=wrap;" vertex="1" parent="33"><mxGeometry x="43" y="17" width="47" height="47" as="geometry"/></mxCell><mxCell id="78" value="Display&lt;br&gt;Visualization" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.display;whiteSpace=wrap;" vertex="1" parent="33"><mxGeometry x="660" y="35" width="100" height="60" as="geometry"/></mxCell><mxCell id="63" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;exitPerimeter=0;entryX=0.5;entryY=0;entryPerimeter=0;startArrow=none;startFill=0;endArrow=classic;endFill=1;jettySize=auto;orthogonalLoop=1;" edge="1" parent="32" source="62"><mxGeometry relative="1" as="geometry"><mxPoint x="578.4545454545453" y="159.81818181818176" as="targetPoint"/></mxGeometry></mxCell><mxCell id="67" value="Yes" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0;exitY=0.5;exitPerimeter=0;entryX=0.5;entryY=0;entryPerimeter=0;startArrow=none;startFill=0;endArrow=classic;endFill=1;jettySize=auto;orthogonalLoop=1;" edge="1" parent="32" source="66" target="34"><mxGeometry x="0.1661" relative="1" as="geometry"><Array as="points"><mxPoint x="30" y="335"/><mxPoint x="30" y="30"/><mxPoint x="353" y="30"/></Array><mxPoint as="offset"/></mxGeometry></mxCell><mxCell id="42" value="System" style="swimlane;html=1;startSize=20;horizontal=0;" vertex="1" parent="32"><mxGeometry y="140" width="770" height="300" as="geometry"/></mxCell><mxCell id="57" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;exitPerimeter=0;entryX=0.5;entryY=0;entryPerimeter=0;jettySize=auto;orthogonalLoop=1;" edge="1" parent="42" source="44" target="55"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="44" value="Hash&lt;br&gt;Password&lt;br&gt;(64 bytes)" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.process;whiteSpace=wrap;" vertex="1" parent="42"><mxGeometry x="208" y="20" width="100" height="60" as="geometry"/></mxCell><mxCell id="45" value="Email&lt;br&gt;Address" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.stored_data;whiteSpace=wrap;" vertex="1" parent="42"><mxGeometry x="72" y="60" width="100" height="60" as="geometry"/></mxCell><mxCell id="47" value="Encryption&lt;br&gt;Nonce" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;exitPerimeter=0;entryX=0;entryY=0.5;entryPerimeter=0;jettySize=auto;orthogonalLoop=1;" edge="1" parent="42" source="48" target="64"><mxGeometry relative="1" as="geometry"><mxPoint x="530.2727272727273" y="49.818181818181756" as="targetPoint"/><Array as="points"><mxPoint x="513" y="150"/><mxPoint x="513" y="100"/><mxPoint x="510" y="100"/><mxPoint x="510" y="50"/></Array></mxGeometry></mxCell><mxCell id="48" value="Hashed Password&lt;div&gt;(24 bytes)&lt;/div&gt;" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.delay;whiteSpace=wrap;" vertex="1" parent="42"><mxGeometry x="396" y="120" width="97" height="60" as="geometry"/></mxCell><mxCell id="49" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;exitPerimeter=0;entryX=0.5;entryY=0;entryPerimeter=0;jettySize=auto;orthogonalLoop=1;" edge="1" parent="42" source="50" target="48"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="50" value="Hash&lt;br&gt;Password&lt;br&gt;(24 bytes)" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.process;whiteSpace=wrap;" vertex="1" parent="42"><mxGeometry x="385" y="20" width="100" height="60" as="geometry"/></mxCell><mxCell id="51" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;exitPerimeter=0;entryX=0.5;entryY=0;entryPerimeter=0;jettySize=auto;orthogonalLoop=1;endArrow=none;endFill=0;startArrow=classic;startFill=1;" edge="1" parent="42" target="53"><mxGeometry relative="1" as="geometry"><mxPoint x="578.4545454545453" y="79.81818181818176" as="sourcePoint"/></mxGeometry></mxCell><mxCell id="61" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;exitPerimeter=0;entryX=0;entryY=0.5;entryPerimeter=0;startArrow=none;startFill=0;endArrow=classic;endFill=1;jettySize=auto;orthogonalLoop=1;" edge="1" parent="42" target="60"><mxGeometry relative="1" as="geometry"><mxPoint x="626.6363636363635" y="49.818181818181756" as="sourcePoint"/></mxGeometry></mxCell><mxCell id="53" value="Encrypted&lt;br&gt;token" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.stored_data;whiteSpace=wrap;" vertex="1" parent="42"><mxGeometry x="570" y="120" width="100" height="60" as="geometry"/></mxCell><mxCell id="58" value="Yes" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;exitPerimeter=0;entryX=0;entryY=0.5;entryPerimeter=0;jettySize=auto;orthogonalLoop=1;" edge="1" parent="42" source="55" target="50"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="68" value="No" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0;exitY=0.5;exitPerimeter=0;entryX=1;entryY=0.5;entryPerimeter=0;startArrow=none;startFill=0;endArrow=classic;endFill=1;jettySize=auto;orthogonalLoop=1;" edge="1" parent="42" source="55" target="66"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="55" value="&lt;div&gt;&lt;span&gt;Same as stored&lt;br&gt;Hashed Password&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;(64 bytes)?&lt;/span&gt;&lt;/div&gt;" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" vertex="1" parent="42"><mxGeometry x="172" y="100" width="172" height="90" as="geometry"/></mxCell><mxCell id="60" value="Get Data&lt;br&gt;From Canvas" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.process;whiteSpace=wrap;" vertex="1" parent="42"><mxGeometry x="660" y="20" width="100" height="60" as="geometry"/></mxCell><mxCell id="64" value="&lt;span&gt;Decrypt&lt;/span&gt;&lt;br&gt;&lt;span&gt;token&lt;/span&gt;" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.process;whiteSpace=wrap;" vertex="1" parent="42"><mxGeometry x="527" y="20" width="100" height="60" as="geometry"/></mxCell><mxCell id="70" value="Yes" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;exitPerimeter=0;entryX=0;entryY=0.5;entryPerimeter=0;startArrow=none;startFill=0;endArrow=classic;endFill=1;jettySize=auto;orthogonalLoop=1;" edge="1" parent="42" source="66" target="69"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="66" value="Try&lt;br&gt;Again?" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" vertex="1" parent="42"><mxGeometry x="50" y="160" width="80" height="70" as="geometry"/></mxCell><mxCell id="77" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;exitPerimeter=0;entryX=0;entryY=0.5;entryPerimeter=0;startArrow=none;startFill=0;endArrow=classic;endFill=1;jettySize=auto;orthogonalLoop=1;" edge="1" parent="42" source="69" target="76"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="69" value="Delete all&lt;br&gt;tokens" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.process;whiteSpace=wrap;" vertex="1" parent="42"><mxGeometry x="208" y="220" width="100" height="60" as="geometry"/></mxCell><mxCell id="76" value="Start from &lt;br&gt;Scratch" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" vertex="1" parent="42"><mxGeometry x="390" y="220" width="100" height="60" as="geometry"/></mxCell><mxCell id="79" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=0;exitPerimeter=0;entryX=0.5;entryY=1;entryPerimeter=0;startArrow=none;startFill=0;endArrow=classic;endFill=1;jettySize=auto;orthogonalLoop=1;" edge="1" parent="32" source="60" target="78"><mxGeometry relative="1" as="geometry"/></mxCell></root></mxGraphModel>